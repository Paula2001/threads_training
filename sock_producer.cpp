//***************************************************************************
//
// Program example for subject Operating Systems
//
// Petr Olivka, Dept. of Computer Science, petr.olivka@vsb.cz, 2021
//
// Example of socket server/client.
//
// This program is example of socket client.
// The mandatory arguments of program is IP adress or name of server and
// a port number.
//
//***************************************************************************

#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <fcntl.h>
#include <stdarg.h>
#include <poll.h>
#include <sys/socket.h>
#include <sys/param.h>
#include <sys/time.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <unistd.h>
#include <errno.h>
#include <netdb.h>

const char *g_names[] = {
"Aaron",
"Ab",
"Abby",
"Abe",
"Abigail",
"Abner",
"Abraham",
"Absalom",
"Ace",
"Ada",
"Adam",
"Addison",
"Addison",
"Adel",
"Adelaide",
"Adele",
"Adolf",
"Adora",
"Adrian",
"Adriana",
"Adrien",
"Ælfweard",
"Agatha",
"Agnes",
"Aidan",
"Aidin",
"Aileen",
"Al",
"Alaina",
"Alan",
"Alanna",
"Albert",
"Alberta",
"Albina",
"Aleana",
"Alec",
"Alex",
"Alex",
"Alexa",
"Alexander",
"Alexandra",
"Alexandria",
"Alexis",
"Alfred",
"Algernon",
"Alice",
"Alicia",
"Alisha",
"Alison",
"Alison",
"Alistair",
"Allan",
"Allen",
"Alma",
"Alvin",
"Alvina",
"Alyson",
"Amadeus",
"Amanda",
"Amber",
"Ambrose",
"Amelia",
"Amy",
"Ana",
"Anderson",
"Andrea",
"Andrée",
"Andrew",
"Andy",
"Andy",
"Angel",
"Angela",
"Angelica",
"Angelina",
"Angie",
"Angus",
"Anna",
"Annabelle",
"Annabeth",
"Anne",
"Annette",
"Annie",
"Anthony",
"Antonia",
"Antony",
"April",
"Arabella",
"Archibald",
"Archie",
"Arda",
"Ariana",
"Ariel",
"Arliss",
"Arlo",
"Armand",
"Armistead",
"Arnaut",
"Arnie",
"Arnold",
"Art",
"Arthur",
"Asher",
"Ashley",
"Ashley",
"Ashton",
"Astrid",
"Aubrey",
"Audra",
"Audrey",
"August",
"Aurora",
"Austen",
"Austin",
"Autumn",
"Averil",
"Avis",
"Aviva",
"Azalea",
"Babette",
"Barb",
"Barbara",
"Baron",
"Barry",
"Bart",
"Bartholomew",
"Basil",
"Bayard",
"Beatrice",
"Beatrix",
"Beau",
"Beau",
"Becca",
"Becki",
"Becky",
"Belinda",
"Bella",
"Ben",
"Benedict",
"Benjamin",
"Benson",
"Berenice",
"Beresford",
"Bernard",
"Bernie",
"Bert",
"Bertha",
"Bertram",
"Bertrand",
"Betsy",
"Bettina",
"Betty",
"Beverly",
"Bianca",
"Bill",
"Billy",
"Blair",
"Blair",
"Blake",
"Blake",
"Blanche",
"Bo",
"Bob",
"Bobbi",
"Bobby",
"Bobby",
"Bonnie",
"Booth",
"Brad",
"Braden",
"Braden",
"Bradley",
"Bram",
"Bramwell",
"Branden",
"Brandon",
"Brandy",
"Braxton",
"Brenda",
"Brian",
"Brianna",
"Bridger",
"Bridget",
"Brielle",
"Brilliana",
"Brock",
"Brody",
"Bronwyn",
"Brooklyn",
"Brooks",
"Bruce",
"Bruno",
"Bryan",
"Brynlee",
"Bryony",
"Bubba",
"Bubby",
"Bud",
"Buddy",
"Burt",
"Burton",
"Butch",
"Byron",
"Caden",
"Caden",
"Caleb",
"Calla",
"Callum",
"Calvin",
"Cameron",
"Candy",
"Canute",
"Cara",
"Cardew",
"Cari",
"Carina",
"Carissa",
"Carl",
"Carlena",
"Carlene",
"Carlie",
"Carlie",
"Carlile",
"Carlisle",
"Carlton",
"Carly",
"Carmelita",
"Carol",
"Carol Ann",
"Carol Anne",
"Carole",
"Carolina",
"Caroline",
"Carolyn",
"Carrie Ann",
"Carrie Anne",
"Carroll",
"Carroll",
"Carry",
"Carson",
"Cary",
"Cary",
"Casey",
"Casey",
"Cassidy",
"Cathleen",
"Cathy",
"Cecil",
"Cecilia",
"Cecily",
"Cedric",
"Celestia",
"Celia",
"Celinda",
"Chad",
"Chadwick",
"Chance",
"Chandler",
"Chandos",
"Chara",
"Charis",
"Charisse",
"Charity",
"Charl",
"Charla",
"Charle",
"Charlee",
"Charlee",
"Charlene",
"Charles",
"Charley",
"Charley",
"Charli",
"Charli",
"Charlie",
"Charlie",
"Charlotte",
"Charlton",
"Charly",
"Charly",
"Charlyne",
"Charmaine",
"Chas",
"Chas",
"Chase",
"Chaz",
"Chazz",
"Chelsea",
"Cherry",
"Cheryl",
"Chester",
"Chet",
"Chip",
"Chloe",
"Chris",
"Chris",
"Christabel",
"Christi",
"Christian",
"Christina",
"Christine",
"Christy",
"Chuck",
"Chucky",
"Ciarán",
"Cindy",
"Claire",
"Claire",
"Clara",
"Clare",
"Clare",
"Clarence",
"Claribel",
"Clarice",
"Clarissa",
"Clark",
"Claude",
"Claudia",
"Clay",
"Clayton",
"Clementine",
"Cletus",
"Cleve",
"Cliff",
"Clifford",
"Clifton",
"Clint",
"Clinton",
"Clinton",
"Clive",
"Clover",
"Clyde",
"Cody",
"Cody",
"Colby",
"Cole",
"Colette",
"Colin",
"Colleen",
"Collin",
"Colman",
"Coloman",
"Colton",
"Connor",
"Conor",
"Conrad",
"Conway",
"Cooper",
"Cora",
"Coral",
"Coraline",
"Corbin",
"Cordelia",
"Corey",
"Corina",
"Cosmo",
"Courtney",
"Courtney",
"Craig",
"Crystal",
"Curtis",
"Curtley",
"Cuthbert",
"Cwichelm",
"Cynthia",
"Cyrus",
"Daisy",
"Dallas",
"Damian",
"Damien",
"Damon",
"Dan",
"Dana",
"Dana",
"Dane",
"Dani",
"Daniel",
"Danielle",
"Danna",
"Danny",
"Daphne",
"Darby",
"Darla",
"Darlene",
"Darren",
"Darvin",
"Darwin",
"Dave",
"David",
"Davina",
"Davis",
"Davy",
"Dawn",
"Dean",
"Deanna",
"Deanne",
"Deb",
"Debbie",
"Deborah",
"Dede",
"Delbert",
"Delia",
"Demetria",
"Demetrius",
"Demi",
"Denis",
"Denise",
"Dennis",
"Denzel",
"Denzil",
"Deorwine",
"Derek",
"Derick",
"Derrick",
"Derwin",
"Des",
"Desmond",
"Destiny",
"Devon",
"Dexter",
"Diamond",
"Diane",
"Dick",
"Dickon",
"Dicky",
"Digby",
"Dimity",
"Dirk",
"Dobie",
"Dom",
"Domenic",
"Dominic",
"Don",
"Donald",
"Donna",
"Dora",
"Doreen",
"Dorian",
"Dorothy",
"Doug",
"Dougie",
"Douglas",
"Drake",
"Drew",
"Drew",
"Drummond",
"Duane",
"Duke",
"Dulcie",
"Duncan",
"Dustin",
"Dutton",
"Dwayne",
"Dwight",
"Dylan",
"Eadwulf",
"Ealdwulf",
"Eardwulf",
"Earl",
"Ebenezer",
"Ebony",
"Ed",
"Eddie",
"Eden",
"Eden",
"Edgar",
"Edison",
"Edith",
"Edmund",
"Edna",
"Edris",
"Edward",
"Edwin",
"Edwina",
"Effie",
"Eileen",
"Elaine",
"Elbert",
"Eleanor",
"Elektra",
"Elias",
"Elijah",
"Elisha",
"Elisha",
"Eliza",
"Elizabeth",
"Ella",
"Elle",
"Ellen",
"Ellie",
"Elliot",
"Ellwood",
"Elmer",
"Elmo",
"Elon",
"Elton",
"Elvis",
"Emanuel",
"Ember",
"Emerald",
"Emerald",
"Emil",
"Emily",
"Emma",
"Emmanuel",
"Emmett",
"Emo",
"Enid",
"Enoch",
"Erastus",
"Eric",
"Erika",
"Erin",
"Ernest",
"Ernie",
"Estelle",
"Esther",
"Esty",
"Ethan",
"Ethel",
"Ethelreda",
"Eudora",
"Eugene",
"Eustace",
"Eva",
"Evan",
"Evan",
"Eve",
"Evelyn",
"Evelyn",
"Eversley",
"Ezekiel",
"Ezra",
"Fabian",
"Fabienne",
"Faith",
"Faye",
"Felicity",
"Felix",
"Fern",
"Finn",
"Finn",
"Fiona",
"Fletcher",
"Fleur",
"Flint",
"Florence",
"Flynn",
"Flynn",
"Ford",
"Forrest",
"Frances",
"Francie",
"Francine",
"Francis",
"Frank",
"Frankie",
"Frankie",
"Franklin",
"Fred",
"Freddy",
"Frederic",
"Frederick",
"Frederick",
"Frida",
"Gabe",
"Gabriel",
"Gage",
"Gage",
"Gail",
"Gale",
"Galton",
"Garrett",
"Garth",
"Gary",
"Gavin",
"Gaylord",
"Gemma",
"Genevieve",
"Geoffrey",
"George",
"Georgene",
"Georgia",
"Georgiana",
"Gerald",
"Gerard",
"Gertie",
"Gertrude",
"Gia",
"Gideon",
"Gilbert",
"Giles",
"Gina",
"Ginny",
"Giovanni",
"Giselle",
"Gladys",
"Glen",
"Glenda",
"Gloria",
"Glynis",
"Godfrey",
"Gorden",
"Gordon",
"Grace",
"Graham",
"Grant",
"Grayson",
"Greg",
"Gregory",
"Griffin",
"Grover",
"Gulliver",
"Gunnar",
"Gunner",
"Gus",
"Guy",
"Gwen",
"Gwenda",
"Gwendolen",
"Gwendoline",
"Gwendolyn",
"Gwyneth",
"Haisley",
"Hal",
"Hale",
"Haley",
"Hank",
"Hannah",
"Hannibal",
"Harmony",
"Harold",
"Harriet",
"Harris",
"Harrison",
"Harry",
"Harvey",
"Harwood",
"Hayden",
"Hayden",
"Hayley",
"Hazel",
"Heather",
"Hector",
"Hedworth",
"Heidi",
"Helen",
"Helena",
"Helene",
"Henrietta",
"Henry",
"Herbert",
"Herman",
"Hero",
"Herschel",
"Hervey",
"Hester",
"Heywood",
"Hilary",
"Hilary",
"Hilda",
"Hodierna",
"Holbrook",
"Holden",
"Holly",
"Homer",
"Honor",
"Hope",
"Hope",
"Horace",
"Horatio",
"Howard",
"Hubert",
"Hudson",
"Hugh",
"Hugo",
"Humphrey",
"Hunter",
"Hunter",
"Ian",
"Ida",
"Iggy",
"Ike",
"Imelda",
"Imogen",
"Increase",
"Ingram",
"Ingrid",
"Iona",
"Irene",
"Iris",
"Irma",
"Isaac",
"Isabel",
"Isabella",
"Isaiah",
"Isidore",
"Isla",
"Israel",
"Ivor",
"Ivy",
"Ivy",
"Jace",
"Jacinta",
"Jack",
"Jack",
"Jackie",
"Jackie",
"Jackson",
"Jacob",
"Jacqueline",
"Jacqui",
"Jade",
"Jaden",
"Jaime",
"Jaime",
"Jake",
"James",
"Jameson",
"Jamie",
"Jamie",
"Jan",
"Jana",
"Jane",
"Janee",
"Janelle",
"Janet",
"Janey",
"Janie",
"January",
"Jared",
"Jarrod",
"Jasmine",
"Jason",
"Jasper",
"Jaxon",
"Jay",
"Jay",
"Jayce",
"Jayda",
"Jayden",
"Jayden",
"Jaylon",
"Jayne",
"Jaynie",
"Jayson",
"Jean",
"Jeanie",
"Jeannie",
"Jeb",
"Jedediah",
"Jeff",
"Jefferson",
"Jeffery",
"Jeffrey",
"Jemima",
"Jemma",
"Jemmy",
"Jenna",
"Jennifer",
"Jenny",
"Jeremiah",
"Jeremy",
"Jermaine",
"Jerome",
"Jerri",
"Jerry",
"Jerry",
"Jess",
"Jess",
"Jesse",
"Jessica",
"Jessie",
"Jet",
"Jethro",
"Jill",
"Jim",
"Jimmy",
"Joan",
"Joanna",
"Joanne",
"Job",
"Jodi",
"Jodie",
"Jodie",
"Jody",
"Joe",
"Joel",
"Joelle",
"Joey",
"Joey",
"John",
"Johnny",
"Johnny",
"Johnson",
"Jolie",
"Jolyon",
"Jon",
"Jonah",
"Jonas",
"Jonathan",
"Jonni",
"Jonnie",
"Jonny",
"Jordan",
"Jordan",
"Jordie",
"Jordy",
"Joseph",
"Josephine",
"Josh",
"Joshua",
"Josiah",
"Josie",
"Joy",
"Joyce",
"Judith",
"Julia",
"Julian",
"Julianne",
"Julie",
"Julien",
"Juliet",
"Julius",
"June",
"Juniper",
"Juno",
"Juno",
"Justin",
"Justine",
"Kaden",
"Kailey",
"Kalla",
"Kane",
"Kara",
"Karen",
"Karin",
"Karl",
"Karlee",
"Karlene",
"Karli",
"Karlie",
"Karly",
"Karolyn",
"Karrie",
"Karyn",
"Karyne",
"Kasey",
"Kate",
"Katey",
"Kathleen",
"Kathryn",
"Kathy",
"Katie",
"Katrina",
"Katy",
"Kay",
"Kay",
"Kayla",
"Kaylee",
"Keith",
"Kelly",
"Kelly",
"Kelsey",
"Kelsey",
"Kelvin",
"Ken",
"Kendrick",
"Kenneth",
"Kenny",
"Kent",
"Kermit",
"Kevin",
"Kian",
"Kierra",
"Kim",
"Kim",
"Kimberly",
"Kimble",
"Kira",
"Kirk",
"Kirsteen",
"Kirstin",
"Kitty",
"Krista",
"Kristen",
"Kristi",
"Kristin",
"Kristy",
"Kurt",
"Kyan",
"Kyle",
"Kylie",
"Kyra",
"Lacey",
"Lana",
"Lance",
"Landon",
"Lanna",
"Lanny",
"Lara",
"Larissa",
"Larry",
"Laura",
"Laurel",
"Lauren",
"Laurence",
"Laurence",
"Lauretta",
"Laurie",
"Laurie",
"Lauryn",
"Lavender",
"Lawrence",
"Lawton",
"Leah",
"Leamon",
"Leanne",
"Lee",
"Lee",
"Leila",
"Leisha",
"Lena",
"Lenna",
"Lenny",
"Leo",
"Leon",
"Leona",
"Leonard",
"Leonora",
"Leopold",
"Leroy",
"Leslie",
"Leslie",
"Lester",
"Lettice",
"Levi",
"Lewis",
"Lexi",
"Liam",
"Lila",
"Liliana",
"Lilibet",
"Lilibeth",
"Lilla",
"Lillian",
"Lillie",
"Lilly",
"Lily",
"Lina",
"Lincoln",
"Linda",
"Lindor",
"Lindsay",
"Lindsay",
"Lindy",
"Linus",
"Lionel",
"Lisa",
"Liza",
"Lizzie",
"Logan",
"Lois",
"Loraine",
"Lorelei",
"Lorena",
"Loretta",
"Lori",
"Lorinda",
"Lorna",
"Lorraine",
"Lottie",
"Lotty",
"Louella",
"Louis",
"Louisa",
"Louise",
"Lucas",
"Lucia",
"Lucinda",
"Lucy",
"Luke",
"Luther",
"Lydia",
"Lyle",
"Lyndsay",
"Lyndsay",
"Lynnette",
"Lysette",
"Mabel",
"Mable",
"Mac",
"Macy",
"Maddox",
"Madelaine",
"Madeleine",
"Madelyn",
"Madge",
"Madison",
"Madison",
"Madonna",
"Maggie",
"Magnolia",
"Mainard",
"Malachi",
"Malcolm",
"Mallory",
"Mandy",
"Mandy",
"Manuel",
"Mara",
"Marcia",
"Marcie",
"Marcus",
"Margaret",
"Margie",
"Margo",
"Maria",
"Mariah",
"Marian",
"Marianne",
"Marie",
"Marigold",
"Marigold",
"Marilyn",
"Marina",
"Mario",
"Marissa",
"Marjorie",
"Mark",
"Marlene",
"Marsha",
"Marshall",
"Marta",
"Martin",
"Martina",
"Marvin",
"Mary",
"Mason",
"Mason",
"Matilda",
"Matt",
"Matthew",
"Matthias",
"Maud",
"Maude",
"Maura",
"Maureen",
"Maurice",
"Maverick",
"Mavis",
"Max",
"Maximilian",
"Maxine",
"May",
"Maya",
"Maynard",
"Mayola",
"McKenna",
"Meara",
"Medea",
"Megan",
"Mehitable",
"Mel",
"Mel",
"Melanie",
"Melina",
"Melinda",
"Melissa",
"Melody",
"Melville",
"Melvin",
"Melvyn",
"Mercedes",
"Meredith",
"Merilyn",
"Merle",
"Merle",
"Merlin",
"Merrilyn",
"Mia",
"Micah",
"Micah",
"Michele",
"Michelle",
"Mike",
"Mikey",
"Mildred",
"Miles",
"Millicent",
"Millie",
"Milo",
"Mina",
"Mindi",
"Mindy",
"Minna",
"Minnie",
"Mira",
"Miranda",
"Miriam",
"Misty",
"Mitch",
"Mitchell",
"Moe",
"Moira",
"Molly",
"Montgomery",
"Montie",
"Monty",
"Morgan",
"Morgan",
"Mort",
"Mortimer",
"Morty",
"Moses",
"Muriel",
"Murray",
"Myra",
"Myrna",
"Myron",
"Myrtle",
"Nadia",
"Nadine",
"Naila",
"Nancy",
"Naomi",
"Narcissa",
"Natalie",
"Nate",
"Nathalie",
"Nathan",
"Nathanael",
"Nathaniel",
"Ned",
"Nehemiah",
"Neil",
"Nelson",
"Nena",
"Nestor",
"Nettie",
"Netty",
"Nevaeh",
"Newt",
"Newton",
"Nia",
"Niall",
"Nicholas",
"Nick",
"Nicki",
"Nicodemus",
"Nicola",
"Nicolas",
"Nicole",
"Nigel",
"Niles",
"Nina",
"Noah",
"Noam",
"Noel",
"Noel",
"Noella",
"Noelle",
"Nolan",
"Norm",
"Norman",
"Nowell",
"Obadiah",
"Odette",
"Odin",
"Olive",
"Oliver",
"Olivia",
"Ollie",
"Opal",
"Orion",
"Orlando",
"Orville",
"Osbert",
"Oscar",
"Osric",
"Oswald",
"Otis",
"Otto",
"Owen",
"Paddy",
"Paddy",
"Paige",
"Palmer",
"Palmer",
"Pamela",
"Paris",
"Paris",
"Patience",
"Patrice",
"Patrick",
"Patsy",
"Patsy",
"Patty",
"Patty",
"Paul",
"Paula",
"Paulina",
"Pearl",
"Peggy",
"Peleg",
"Penelope",
"Penny",
"Pepper",
"Percival",
"Percy",
"Perry",
"Perry",
"Persis",
"Pete",
"Peter",
"Petrina",
"Petula",
"Petunia",
"Philip",
"Philippa",
"Phillipps",
"Phineas",
"Phoebe",
"Pixie",
"Poe",
"Poppy",
"Porter",
"Posy",
"Posy",
"Precious",
"Preston",
"Primrose",
"Priscilla",
"Quentin",
"Quincy",
"Rachel",
"Rafe",
"Raife",
"Rain",
"Raleigh",
"Raleigh",
"Ralph",
"Ralphie",
"Ramona",
"Ramsey",
"Randall",
"Randi",
"Randolph",
"Randy",
"Randy",
"Raphael",
"Rathbone",
"Ray",
"Raymond",
"Reba",
"Rebecca",
"Reese",
"Reggie",
"Regina",
"Reginald",
"Rembrandt",
"Rendell",
"Renssalaer",
"Reuben",
"Rex",
"Reynold",
"Rhett",
"Rhiannon",
"Rhoda",
"Rhonda",
"Rich",
"Richard",
"Richie",
"Rick",
"Ricky",
"Riley",
"Riley",
"Risa",
"Rita",
"Rob",
"Robbie",
"Robert",
"Roberta",
"Robin",
"Robin",
"Roderick",
"Rodger",
"Rodney",
"Roger",
"Rogers",
"Roland",
"Roman",
"Romilda",
"Ron",
"Ronald",
"Ronnie",
"Ronnie",
"Rosaleen",
"Rosalie",
"Rosalind",
"Rosalyn",
"Rosamund",
"Roscoe",
"Rose",
"Rosemary",
"Rosie",
"Ross",
"Rowland",
"Ruby",
"Rudolph",
"Rudy",
"Rufus",
"Rupert",
"Russ",
"Russell",
"Russi",
"Ruth",
"Ryan",
"Ryder",
"Sabrina",
"Sadie",
"Salma",
"Sam",
"Sam",
"Samantha",
"Sammy",
"Samson",
"Samuel",
"Sandi",
"Sandra",
"Sandy",
"Sanford",
"Sapphire",
"Sarah",
"Saul",
"Sawyer",
"Scarlett",
"Scott",
"Sean",
"Sebastian",
"Selena",
"Selma",
"Serena",
"Seth",
"Shahaf",
"Shane",
"Shania",
"Sharla",
"Sharleen",
"Sharlene",
"Sharon",
"Shaun",
"Shawn",
"Shawna",
"Shayne",
"Sheena",
"Shelley",
"Shepherd",
"Sherry",
"Sheryl",
"Shirley",
"Sibyl",
"Sid",
"Sid",
"Sidney",
"Sidney",
"Sienna",
"Sigmund",
"Simon",
"Simone",
"Sky",
"Sky",
"Skyler",
"Skyler",
"Sol",
"Solomon",
"Sophia",
"Sophie",
"Sorrel",
"Spencer",
"Spring",
"Stacy",
"Stan",
"Stanford",
"Stanley",
"Stefan",
"Stella",
"Stephanie",
"Stephen",
"Stetson",
"Steve",
"Stevie",
"Stevie",
"Stewart",
"Stuart",
"Summer",
"Susan",
"Susanna",
"Susanne",
"Sutton",
"Suzanne",
"Swaine",
"Syd",
"Syd",
"Sydney",
"Sydney",
"Sylvester",
"Sylvia",
"Sylvie",
"Tabitha",
"Talitha",
"Tallulah",
"Tamara",
"Tammy",
"Tanner",
"Tara",
"Taran",
"Taylor",
"Taylor",
"Tazewell",
"Ted",
"Teddy",
"Terence",
"Teresa",
"Terry",
"Terry",
"Thaddeus",
"Thelma",
"Theo",
"Theodore",
"Thomas",
"Thomasina",
"Thor",
"Tiffany",
"Tigerlily",
"Tim",
"Timmy",
"Timothy",
"Tobias",
"Toby",
"Tod",
"Todd",
"Toddy",
"Tom",
"Tommie",
"Tommy",
"Tonja",
"Tony",
"Tonya",
"Tori",
"Tracy",
"Tracy",
"Travis",
"Tregonwell",
"Trent",
"Trevor",
"Trey",
"Trisha",
"Tristan",
"Troy",
"Trudy",
"Truman",
"Tucker",
"Tucker",
"Tyler",
"Tyler",
"Tyra",
"Tyrone",
"Tyson",
"Ultan",
"Ulysses",
"Uriah",
"Ursula",
"Val",
"Val",
"Valarie",
"Valda",
"Valentine",
"Valerie",
"Vanessa",
"Velma",
"Velvet",
"Venetia",
"Venus",
"Vera",
"Vernon",
"Veronica",
"Vic",
"Vicary",
"Vicky",
"Victor",
"Victoria",
"Vilma",
"Vince",
"Vincent",
"Vinny",
"Viola",
"Violet",
"Violette",
"Virginia",
"Vivian",
"Vivian",
"Wade",
"Wadsworth",
"Walden",
"Waldo",
"Walker",
"Wallace",
"Wally",
"Walt",
"Walter",
"Wanda",
"Warren",
"Waverly",
"Waverly",
"Wayne",
"Wells",
"Wendy",
"Wes",
"Wesley",
"Whitney",
"Whitney",
"Wilber",
"Wilbert",
"Wilbur",
"Wilf",
"Wilfred",
"Wilfried",
"Wilhelm",
"Will",
"Willard",
"William",
"Willow",
"Willy",
"Wilma",
"Wilmon",
"Wilson",
"Winifred",
"Winnie",
"Winnie",
"Winnifred",
"Winston",
"Winter",
"Wolfgang",
"Woodrow",
"Woodruff",
"Woody",
"Wyatt",
"Wyndham",
"Xander",
"Xavier",
"Yasmin",
"Yvette",
"Yvonne",
"Zachary",
"Zack",
"Zelda",
"Zoe",
};

#define STR_CLOSE               "close"

//***************************************************************************
// log messages

#define LOG_ERROR               0       // errors
#define LOG_INFO                1       // information and notifications
#define LOG_DEBUG               2       // debug messages

// debug flag
int g_debug = LOG_INFO;

void log_msg( int t_log_level, const char *t_form, ... )
{
    const char *out_fmt[] = {
            "ERR: (%d-%s) %s\n",
            "INF: %s\n",
            "DEB: %s\n" };

    if ( t_log_level && t_log_level > g_debug ) return;

    char l_buf[ 1024 ];
    va_list l_arg;
    va_start( l_arg, t_form );
    vsprintf( l_buf, t_form, l_arg );
    va_end( l_arg );

    switch ( t_log_level )
    {
    case LOG_INFO:
    case LOG_DEBUG:
        fprintf( stdout, out_fmt[ t_log_level ], l_buf );
        break;

    case LOG_ERROR:
        fprintf( stderr, out_fmt[ t_log_level ], errno, strerror( errno ), l_buf );
        break;
    }
}

//***************************************************************************
// help

void help( int t_narg, char **t_args )
{
    if ( t_narg <= 1 || !strcmp( t_args[ 1 ], "-h" ) )
    {
        printf(
            "\n"
            "  Socket client example.\n"
            "\n"
            "  Use: %s [-h -d] ip_or_name port_number\n"
            "\n"
            "    -d  debug mode \n"
            "    -h  this help\n"
            "\n", t_args[ 0 ] );

        exit( 0 );
    }

    if ( !strcmp( t_args[ 1 ], "-d" ) )
        g_debug = LOG_DEBUG;
}

//***************************************************************************

int main( int t_narg, char **t_args )
{

    if ( t_narg <= 2 ) help( t_narg, t_args );

    int l_port = 0;
    char *l_host = nullptr;

    // parsing arguments
    for ( int i = 1; i < t_narg; i++ )
    {
        if ( !strcmp( t_args[ i ], "-d" ) )
            g_debug = LOG_DEBUG;

        if ( !strcmp( t_args[ i ], "-h" ) )
            help( t_narg, t_args );

        if ( *t_args[ i ] != '-' )
        {
            if ( !l_host )
                l_host = t_args[ i ];
            else if ( !l_port )
                l_port = atoi( t_args[ i ] );
        }
    }

    if ( !l_host || !l_port )
    {
        log_msg( LOG_INFO, "Host or port is missing!" );
        help( t_narg, t_args );
        exit( 1 );
    }

    log_msg( LOG_INFO, "Connection to '%s':%d.", l_host, l_port );

    addrinfo l_ai_req, *l_ai_ans;
    bzero( &l_ai_req, sizeof( l_ai_req ) );
    l_ai_req.ai_family = AF_INET;
    l_ai_req.ai_socktype = SOCK_STREAM;

    int l_get_ai = getaddrinfo( l_host, nullptr, &l_ai_req, &l_ai_ans );
    if ( l_get_ai )
    {
        log_msg( LOG_ERROR, "Unknown host name!" );
        exit( 1 );
    }

    sockaddr_in l_cl_addr =  *( sockaddr_in * ) l_ai_ans->ai_addr;
    l_cl_addr.sin_port = htons( l_port );
    freeaddrinfo( l_ai_ans );

    // socket creation
    int l_sock_server = socket( AF_INET, SOCK_STREAM, 0 );
    if ( l_sock_server == -1 )
    {
        log_msg( LOG_ERROR, "Unable to create socket.");
        exit( 1 );
    }

    // connect to server
    if ( connect( l_sock_server, ( sockaddr * ) &l_cl_addr, sizeof( l_cl_addr ) ) < 0 )
    {
        log_msg( LOG_ERROR, "Unable to connect server." );
        exit( 1 );
    }

    uint l_lsa = sizeof( l_cl_addr );
    // my IP
    getsockname( l_sock_server, ( sockaddr * ) &l_cl_addr, &l_lsa );
    log_msg( LOG_INFO, "My IP: '%s'  port: %d",
             inet_ntoa( l_cl_addr.sin_addr ), ntohs( l_cl_addr.sin_port ) );
    // server IP
    getpeername( l_sock_server, ( sockaddr * ) &l_cl_addr, &l_lsa );
    log_msg( LOG_INFO, "Server IP: '%s'  port: %d",
             inet_ntoa( l_cl_addr.sin_addr ), ntohs( l_cl_addr.sin_port ) );

    log_msg( LOG_INFO, "Enter 'close' to close application." );

    // list of fd sources

    // go!
    int index = 0; 
    char role[] = "PRODUCER";
    write( l_sock_server, role, strlen( role ) );
    sleep( 1 );
    while ( 1 )
    {
            int l_len = write( l_sock_server, g_names[ index ], strlen( g_names[ index ] ) );
            if ( l_len < 0 )
                log_msg( LOG_ERROR, "Unable to send data to server." );
            else
                log_msg( LOG_DEBUG, "Sent %d bytes to server.", l_len );

            index++;
            if ( index > 1555 ) index = 0;

            // read data from server
            char l_buf[ 128 ];
            l_len = read( l_sock_server, l_buf, sizeof( l_buf ) );
            if ( !l_len )
            {
                log_msg( LOG_DEBUG, "Server closed socket." );
                break;
            }
            else if ( l_len < 0 )
            {
                log_msg( LOG_ERROR, "Unable to read data from server." );
                break;
            }
            else
                log_msg( LOG_DEBUG, "Read %d bytes from server.", l_len );

            l_buf[ l_len ] = 0;

            if ( strncmp(  l_buf, "ACK", 3 ) != 0 )
                log_msg( LOG_INFO, "Answer is not ACK." );

    }

    // close socket
    close( l_sock_server );

    return 0;
  }
